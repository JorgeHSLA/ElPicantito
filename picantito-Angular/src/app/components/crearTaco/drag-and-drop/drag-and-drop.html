<div class="taco-builder-container">
    <div class="header">
        <h1>üåÆ Crea Tu Taco Personalizado</h1>
        <p class="subtitle">Arrastra los ingredientes para construir tu taco perfecto</p>
    </div>

    <div class="builder-wrapper">
        <!-- Panel de ingredientes disponibles -->
        <div class="ingredients-panel">
            <div class="panel-header">
                <h2>Ingredientes Disponibles</h2>
                <span class="step-indicator">{{currentStep()}}</span>
            </div>

            <!-- Botones de navegaci√≥n entre categor√≠as -->
            <div class="step-navigation">
                <button 
                    class="nav-btn btn-prev" 
                    (click)="goToPreviousStep()"
                    [disabled]="currentStep() === 'tortilla'">
                    ‚Üê Anterior
                </button>
                <div class="step-info">
                    @if(currentStep() === 'tortilla') {
                        <span>Elige 1 tortilla</span>
                    } @else if(currentStep() === 'prote√≠na') {
                        <span>Elige prote√≠na(s)</span>
                    } @else if(currentStep() === 'salsa') {
                        <span>Elige salsa(s)</span>
                    } @else {
                        <span>Agrega extras (opcional)</span>
                    }
                </div>
                <button 
                    class="nav-btn btn-next" 
                    (click)="goToNextStep()"
                    [disabled]="!canGoToNextStep() || currentStep() === 'extras'">
                    Siguiente ‚Üí
                </button>
            </div>

            <div
                cdkDropList
                id="todoList"
                #todoList="cdkDropList"
                [cdkDropListConnectedTo]="[doneList]"
                [cdkDropListData]="todo()"
                class="ingredients-list"
                (cdkDropListDropped)="drop($event)">
                @for(item of todo(); track item.idAdcional) {
                    <div class="ingredient-card" cdkDrag>
                        <div class="ingredient-content">
                            <div class="ingredient-icon">üç¥</div>
                            <div class="ingredient-info">
                                <h3>{{item.nombre}}</h3>
                                <span class="price">${{item.precio}}</span>
                            </div>
                        </div>
                        <div class="drag-indicator">‚ãÆ‚ãÆ</div>
                    </div>
                }
                @if(todo().length === 0 && currentStep() === 'tortilla') {
                    <div class="empty-message">
                        <p>‚ú® Ya seleccionaste tu tortilla</p>
                    </div>
                }
                @if(currentStep() !== 'tortilla') {
                    <div class="info-message">
                        <p>üí° Puedes agregar varios ingredientes de esta categor√≠a</p>
                    </div>
                }
            </div>
        </div>

        <!-- Panel del taco en construcci√≥n -->
        <div class="taco-panel">
            <div class="panel-header">
                <h2>Tu Taco</h2>
                <span class="total-price">Total: ${{totalPrice()}}</span>
            </div>
            <div
                cdkDropList
                id="doneList"
                #doneList="cdkDropList"
                [cdkDropListConnectedTo]="[todoList]"
                [cdkDropListData]="done()"
                class="taco-list"
                (cdkDropListDropped)="drop($event)">
                @for(item of done(); track item.idAdcional) {
                    <div class="taco-ingredient" cdkDrag>
                        <div class="ingredient-content">
                            <div class="ingredient-icon">‚úì</div>
                            <div class="ingredient-info">
                                <h3>{{item.nombre}}</h3>
                                <span class="price">${{item.precio}}</span>
                            </div>
                        </div>
                        <div class="drag-indicator">‚ãÆ‚ãÆ</div>
                    </div>
                }
                @if(done().length === 0) {
                    <div class="empty-taco">
                        <div class="taco-icon">üåÆ</div>
                        <p>Arrastra ingredientes aqu√≠ para comenzar</p>
                        <p class="hint">Empieza con una tortilla</p>
                    </div>
                }
            </div>
            
            @if(done().length > 0) {
                <div class="action-buttons">
                    <button class="btn-primary">Agregar al Carrito</button>
                    <button class="btn-secondary" (click)="clearTaco()">Limpiar</button>
                </div>
            }
        </div>
    </div>
</div>
